<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>M&M Agro Farms â€“ Order</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f5f5f5;
      text-align: center;
    }

    .blink-sunday {
      display: inline-block;
      padding: 8px 12px;
      border-radius: 4px;
      animation: blink-bg 1s steps(1, start) infinite,
                 blink-color 1s steps(1, start) infinite;
    }

    @keyframes blink-bg {
      0%, 50% { background-color: #FFEB3B; }
      51%, 100% { background-color: #F8BBD0; }
    }

    @keyframes blink-color {
      0%, 50% { color: #2e7d32; }
      51%, 100% { color: #880E4F; }
    }

    h2 {
      color: #2e7d32;
      font-size: 36px;
      margin-bottom: 10px;
    }

    h3 {
      color: #FFB6C1;
      margin-bottom: 20px;
    }

    .order-form {
      background-color: #e0f2f1;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 0 16px rgba(0, 0, 0, 0.1);
      max-width: 600px;
      margin: 0 auto;
      text-align: left;
    }

    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }

    input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    input[readonly] {
      background-color: #f0f0f0;
      color: #555;
    }

    #totalAmount {
      font-size: 20px;
      margin-top: 20px;
      color: #d32f2f;
      font-weight: bold;
    }

    button {
      margin-top: 25px;
      background-color: #388e3c;
      color: #000;
      padding: 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 18px;
    }

    button:hover {
      background-color: #2e7d32;
    }
  </style>
</head>
<body>
  <h1>ğŸŒ¿ M&M Agro Farms ğŸŒ¿</h2>
  <h4 class="blink-sunday">Delivery available only on Sundays.Orders accepted until Saturday 9:00 PM.</h4>

  <div class="order-form">
    <form id="orderForm">
      <label for="name">ğŸ‘¤ Name:</label>
      <input type="text" id="name" name="name" required />

      <label for="mobile">ğŸ“ Mobile:</label>
      <input type="tel" id="mobile" name="mobile" required />

      <label for="mutton">ğŸ“¦ Mutton (â‚¹850/kg):</label>
      <input type="number" id="mutton" name="mutton" min="0" value="0" step="0.001" />

      <label for="chicken">ğŸ“¦ Desi Chicken (â‚¹550/kg):</label>
      <input type="number" id="chicken" name="chicken" min="0" value="0" step="0.001" />

      <label for="eggs">ğŸ¥š Desi Eggs (â‚¹13 each):</label>
      <input type="number" id="eggs" name="eggs" min="0" value="0" step="1" />

      <label for="orderDate">ğŸ“… Order Date:</label>
      <input type="date" id="orderDate" name="orderDate" required />

      <label for="deliveryDate">ğŸ—“ï¸ Delivery Date (Auto-set to Next Sunday):</label>
      <input type="text" id="deliveryDate" readonly />

      <label for="address">ğŸ“ Address:</label>
      <textarea id="address" name="address" required></textarea>

      <label for="notes">ğŸ“ Notes (Optional):</label>
      <textarea id="notes" name="notes"></textarea>

      <div id="totalAmount">ğŸ’° Total: â‚¹0.00</div>
      <button type="submit">Submit Order</button>
    </form>
  </div>

  <script>
    const prices = { mutton: 850, chicken: 550, eggs: 13 };
    const muttonEl = document.getElementById("mutton");
    const chickenEl = document.getElementById("chicken");
    const eggsEl = document.getElementById("eggs");
    const totalEl = document.getElementById("totalAmount");

    function calculateTotal() {
      const total =
        (parseFloat(muttonEl.value || 0) * prices.mutton) +
        (parseFloat(chickenEl.value || 0) * prices.chicken) +
        (parseFloat(eggsEl.value || 0) * prices.eggs);
      totalEl.innerText = `ğŸ’° Total: â‚¹${total.toFixed(2)}`;
      return total;
    }

    [muttonEl, chickenEl, eggsEl].forEach(i =>
      i.addEventListener("input", calculateTotal)
    );

    function getNextSunday() {
      const today = new Date();
      const diff = (7 - today.getDay()) % 7 || 7;
      const next = new Date(today.getFullYear(), today.getMonth(), today.getDate() + diff);
      return next;
    }

    function formatDate(date) {
      return date.toLocaleDateString("en-IN", {
        weekday: "long",
        year: "numeric",
        month: "short",
        day: "numeric"
      });
    }

    function formatDateTime(date) {
      return date.toLocaleString("en-IN", {
        year: "numeric",
        month: "short",
        day: "numeric",
        hour: "2-digit",
        minute: "2-digit"
      });
    }

    window.onload = () => {
      const nextSunday = getNextSunday();
      document.getElementById("deliveryDate").value = formatDate(nextSunday);
    };

    document.getElementById("orderForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const now = new Date();
      const orderCutoff = new Date();
      orderCutoff.setDate(orderCutoff.getDate() + ((6 - orderCutoff.getDay() + 7) % 7)); // Saturday
      orderCutoff.setHours(21, 0, 0, 0); // 9 PM

      if (now > orderCutoff) {
        alert("ğŸš« Orders after Saturday 9:00 PM are not accepted for Sunday delivery.");
        return;
      }

      const name = document.getElementById("name").value;
      const mobile = document.getElementById("mobile").value;
      const mQty = parseFloat(muttonEl.value || 0);
      const cQty = parseFloat(chickenEl.value || 0);
      const eQty = parseFloat(eggsEl.value || 0);
      const orderDate = document.getElementById("orderDate").value;
      const orderTime = formatDateTime(now);
      const deliveryDate = document.getElementById("deliveryDate").value;
      const address = document.getElementById("address").value;
      const notes = document.getElementById("notes").value;
      const total = calculateTotal();
      const orderId = `MM${Math.floor(100000 + Math.random() * 900000)}`;

      const message =
        "ğŸŒ¿ M&M Agro Farms ğŸŒ¿\n" +
        "Your Order Details:\n" +
        `ğŸ†” Order ID: ${orderId}\n` +
        `ğŸ‘¤ Name: ${name}\n` +
        `ğŸ“ Mobile: ${mobile}\n` +
        `ğŸ“¦ Qty: ${mQty}â€¯kg Mutton, ${cQty}â€¯kg Chicken, ${eQty} Eggs\n` +
        `ğŸ’° Total: â‚¹${total.toFixed(2)}\n` +
        `ğŸ“ Address: ${address}\n` +
        `ğŸ“… Order Date: ${orderDate}\n` +
        `â° Order Time: ${orderTime}\n` +
        `ğŸšš Delivery Date: ${deliveryDate}\n` +
        `ğŸ“ Notes: ${notes || "-"}\n` +
        `âœ… Thank you for choosing M&M Agro Farms!`;

      const encoded = encodeURIComponent(message);
      window.open(`https://wa.me/91${mobile}?text=${encoded}`, '_blank');
      setTimeout(() => window.open(`https://wa.me/918688014021?text=${encoded}`, '_blank'), 500);
      alert("âœ… Order submitted! Redirecting to WhatsApp.");
      this.reset();
      calculateTotal();
    });
  </script>
</body>
</html>
