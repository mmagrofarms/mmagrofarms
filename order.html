<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>M&M Agro Farms Order Form</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .form-group { margin-bottom: 15px; }
    label { display: block; font-weight: bold; }
    input, textarea, select { width: 100%; padding: 8px; margin-top: 5px; }
    #totalAmount { font-size: 18px; font-weight: bold; color: green; margin-top: 15px; }
    button { padding: 10px 20px; font-size: 16px; }
  </style>
</head>
<body>
  <h2>ðŸ›’ M&M Agro Farms Order Form</h2>

  <form id="orderForm">
    <div class="form-group">
      <label for="name">Customer Name:</label>
      <input type="text" id="name" name="name" required>
    </div>

    <div class="form-group">
      <label for="mobile">Customer Mobile (WhatsApp):</label>
      <input type="tel" id="mobile" name="mobile" pattern="[0-9]{10}" required>
    </div>

    <div class="form-group">
      <label for="muttonQty">Mutton Quantity (kg) @ â‚¹850/kg:</label>
      <input type="number" id="muttonQty" name="muttonQty" min="0" step="0.5">
    </div>

    <div class="form-group">
      <label for="chickenQty">Desi Chicken Quantity (kg) @ â‚¹550/kg:</label>
      <input type="number" id="chickenQty" name="chickenQty" min="0" step="0.5">
    </div>

    <div class="form-group">
      <label for="eggQty">Desi Eggs (number) @ â‚¹13/egg:</label>
      <input type="number" id="eggQty" name="eggQty" min="0" step="1">
    </div>

    <div class="form-group">
      <label for="address">Delivery Address:</label>
      <textarea id="address" name="address" required></textarea>
    </div>

    <div class="form-group">
      <label for="deliveryTime">Preferred Delivery Time:</label>
      <input type="text" id="deliveryTime" name="deliveryTime">
    </div>

    <div class="form-group">
      <label for="notes">Any Notes:</label>
      <textarea id="notes" name="notes"></textarea>
    </div>

    <div id="totalAmount">Total: â‚¹0</div>
    <br>
    <button type="submit">Submit Order</button>
  </form>

  <script>
    const form = document.getElementById('orderForm');
    const totalDisplay = document.getElementById('totalAmount');

    const rates = {
      mutton: 850,
      chicken: 550,
      egg: 13
    };

    function calculateTotal() {
      const muttonQty = parseFloat(document.getElementById('muttonQty').value) || 0;
      const chickenQty = parseFloat(document.getElementById('chickenQty').value) || 0;
      const eggQty = parseInt(document.getElementById('eggQty').value) || 0;
      const total = (muttonQty * rates.mutton) + (chickenQty * rates.chicken) + (eggQty * rates.egg);
      totalDisplay.textContent = `Total: â‚¹${total}`;
      return total;
    }

    document.getElementById('muttonQty').addEventListener('input', calculateTotal);
    document.getElementById('chickenQty').addEventListener('input', calculateTotal);
    document.getElementById('eggQty').addEventListener('input', calculateTotal);

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const now = new Date();
      const isSaturday = now.getDay() === 6;
      const isAfter9pm = now.getHours() >= 21;
      if (isSaturday && isAfter9pm) {
        alert('Order cut-off time has passed. Orders are closed after Saturday 9PM.');
        return;
      }

      const data = new FormData(form);
      const name = data.get('name');
      const mobile = data.get('mobile');
      const muttonQty = parseFloat(data.get('muttonQty')) || 0;
      const chickenQty = parseFloat(data.get('chickenQty')) || 0;
      const eggQty = parseInt(data.get('eggQty')) || 0;
      const total = calculateTotal();
      const address = data.get('address');
      const deliveryTime = data.get('deliveryTime');
      const notes = data.get('notes');

      const message = `ðŸ§¾ *Order Confirmation*\nName: ${name}\nPhone: ${mobile}\nMutton: ${muttonQty} kg\nChicken: ${chickenQty} kg\nEggs: ${eggQty} pcs\nTotal: â‚¹${total}\nAddress: ${address}\nDelivery Time: ${deliveryTime}\nNotes: ${notes}`;

      // Send to Google Apps Script
      const scriptURL = 'YOUR_GOOGLE_SCRIPT_WEB_APP_URL';
      await fetch(scriptURL, {
        method: 'POST',
        body: data
      });

      // Send WhatsApp to customer
      const whatsappURL = `https://wa.me/91${mobile}?text=${encodeURIComponent(message)}`;
      window.open(whatsappURL, '_blank');

      // Send WhatsApp to admin
      const adminNumber = '918688014021';
      const adminWhatsApp = `https://wa.me/${adminNumber}?text=${encodeURIComponent('[ADMIN COPY]\n' + message)}`;
      window.open(adminWhatsApp, '_blank');

      alert('âœ… Order submitted successfully! You will receive a WhatsApp confirmation.');
      form.reset();
      calculateTotal();
    });
  </script>
</body>
</html>
